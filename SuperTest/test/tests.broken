const supertestRequest = require('supertest');
const assert = require('assert');
const console = require('console');

const http = require('http');

const dummyServer = http.createServer( function () {} ).listen( 9999 );

const target = 'http://default.web.mw.localhost:8080/mediawiki';
/*
request = ( function( server, target ) {
	function request() {
		res = supertestRequest( server );
		superGet = res.get;
		res.get = function( url ) {
			console.log( `${target}${url}` );
			return superGet.call( res, `${target}${url}` );
		}
		
		return res;
	};
	
	return request;
} ) ( dummyServer, target );

const anonAgent = request();
*/
describe('SuperAgent GET /index.php/Main_Page', function() {
  it('responds with HTML', function(done) {
	console.log( `${target}/index.php/Main_Page` );
    supertestRequest( dummyServer )
      .get(`${target}/index.php/Main_Page`)
      .expect('Content-Type', /^text\/html/)
      .expect(200, done);
  });
});

/*
describe('MyAgent GET /index.php/Main_Page', function() {
  it('responds with HTML', function(done) {
    anonAgent
      .get('/index.php/Main_Page')
      .expect('Content-Type', /^text\/html/)
      .expect(200, done);
  });
});
*/
dummyServer.close();
